# Export Remediation Guide

## Overview

The **Export Fixes** feature allows users to download all accessibility remediation guidance from a scan as a single, comprehensive Markdown file. This makes it easy to share fixes with developers, track progress, and integrate with project management tools.

## Features

### ðŸ“¥ One-Click Export
- Single button click downloads a complete remediation guide
- No additional steps or configuration required
- Works offline after generation

### ðŸ“„ Comprehensive Documentation
The exported Markdown file includes:
- **Scan metadata** (site name, URL, date, score, total issues)
- **Table of contents** with jump links
- **Grouped issues** by rule type (avoiding duplication)
- **Step-by-step fix instructions** for each issue
- **Code examples** with before/after comparisons
- **WCAG references** with official documentation links
- **Affected elements** with selectors and HTML snippets
- **Additional resources** (WCAG guides, tools, etc.)

### âœ¨ Developer-Friendly Format
- **Markdown format** - readable in any text editor, renders beautifully on GitHub, GitLab, etc.
- **Clean structure** - organized by issue type, not individual instances
- **Copy-paste ready** - code examples formatted for immediate use
- **Version control friendly** - track remediation progress over time

## User Experience

### In the UI

**Location:** Scan report page, next to "Accessibility Issues" heading

**Button:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“„ Export Fixes            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**States:**
- **Default:** "ðŸ“„ Export Fixes"
- **Exporting:** "â¬‡ï¸ Exporting..." (animated download icon)
- **Disabled:** Grayed out when no issues found
- **Tooltip:** "Export all remediation guidance as Markdown"

### File Output

**Filename format:** `{site-name}-remediation-{date}.md`
- Example: `alterra-remediation-2024-09-30.md`

**File size:** Typically 10-50 KB (highly compressible)

## Example Export Structure

```markdown
# Accessibility Remediation Guide

**Site:** Alterra
**URL:** https://alterra.studio
**Scan Date:** September 30, 2024, 12:17 AM
**Accessibility Score:** 91%
**Total Issues:** 17

---

## ðŸ“‹ Table of Contents

1. [Fix Enhanced Color Contrast (AAA)](#1-fix-enhanced-color-contrast-aaa) (3 instances)
2. [Fix Color Contrast](#2-fix-color-contrast) (8 instances)
3. [Add Title to iframes](#3-add-title-to-iframes) (4 instances)
4. [Add Accessible Link Name](#4-add-accessible-link-name) (2 instances)

---

## 1. Fix Enhanced Color Contrast (AAA)

**Rule:** `color-contrast-enhanced`
**Impact:** serious
**Instances Found:** 3

### ðŸ“ Issue Description

Text must meet enhanced contrast requirements for AAA compliance.

### âœ… How to Fix

1. Use a contrast checker to measure current contrast ratio
2. For normal text, achieve a contrast ratio of at least 7:1
3. For large text (â‰¥ 18pt or â‰¥ 14pt bold), achieve at least 4.5:1
4. Consider using darker text colors or lighter backgrounds
5. Test with actual users who have low vision if possible

### ðŸ’» Code Example

```html
/* Enhanced contrast example */
color: #000; background: #fff; /* 21:1 - Excellent */
color: #333; background: #fff; /* 12.6:1 - Strong */
```

### ðŸ“š WCAG Reference

**Standard:** WCAG 2.1 Level AAA - Success Criterion 1.4.6
**Documentation:** https://dequeuniversity.com/rules/axe/4.10/color-contrast-enhanced

### ðŸŽ¯ Affected Elements (3)

#### Instance 1

**Selector:**
```css
.hero-section > p
```

**HTML:**
```html
<p class="hero-text">Welcome to our site</p>
```

#### Instance 2
...

---

## ðŸ”§ Additional Resources

- [WCAG 2.1 Quick Reference](https://www.w3.org/WAI/WCAG21/quickref/)
- [W3C ARIA Authoring Practices](https://www.w3.org/WAI/ARIA/apg/)
- [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)
- [MDN Web Accessibility](https://developer.mozilla.org/en-US/docs/Web/Accessibility)

---

*Generated by Auditvia - https://auditvia.com*
*Scan ID: 23f76c2e-6f97-4be9-b891-5cb97a79bd0e*
```

## Technical Implementation

### Files Created

**1. `src/lib/export-remediation.ts`**
- `generateRemediationMarkdown()` - Generates the Markdown content
- `downloadRemediationFile()` - Triggers browser download
- `exportRemediationGuide()` - Main entry point combining both
- `slugify()` - Helper for generating clean filenames

**2. `src/app/components/ui/ExportRemediationButton.tsx`**
- Client component with export button
- Toast notifications for success/error
- Loading states and animations
- Disabled state when no issues
- Variants: `default` (blue) and `outline` (white/dark)
- Sizes: `sm`, `md`, `lg`

### Integration Points

**Modified Files:**
- `src/app/dashboard/reports/[scanId]/page.tsx` - Added Export button to report header

### Data Flow

```
User clicks "Export Fixes"
  â†“
ExportRemediationButton.tsx (onClick handler)
  â†“
exportRemediationGuide() called with issues + metadata
  â†“
generateRemediationMarkdown() creates Markdown string
  â†“
downloadRemediationFile() triggers browser download
  â†“
User saves .md file to disk
  â†“
Success toast notification
```

## Use Cases

### 1. Developer Handoff
**Scenario:** Design team runs scan, exports fixes for dev team

**Benefits:**
- Developers get clear, actionable instructions
- No need to log into Auditvia
- Can be attached to tickets/PRs
- Tracks what needs to be fixed

### 2. Progress Tracking
**Scenario:** Export before and after fixes to compare

**Benefits:**
- Version control friendly (Git diff)
- Shows which issues were resolved
- Documents remediation effort
- Proves compliance improvements

### 3. Client Reporting
**Scenario:** Agency delivers accessibility audit to client

**Benefits:**
- Professional, comprehensive documentation
- Client can share with their team
- No technical barriers (Markdown is readable)
- Includes all necessary references

### 4. Linear/Jira Integration
**Scenario:** Create tickets from exported guidance

**Benefits:**
- Copy-paste issue descriptions and steps
- One export â†’ multiple tickets
- Consistent formatting
- Includes code examples and WCAG refs

## Future Enhancements

### Potential Improvements
- **Format options:** PDF, HTML, DOCX
- **Customizable templates:** Add company branding, custom sections
- **Bulk export:** Export all scans for a site
- **Auto-attach to emails:** Send remediation guide on scan completion
- **GitHub integration:** Auto-create issues from export
- **Linear integration:** Auto-create tickets with remediation steps
- **Progress tracking:** Mark issues as fixed in export, re-export shows diff

### Analytics Opportunities
- Track export frequency per user/team
- Most exported issue types
- Export â†’ fix completion correlation

## Design Decisions

### Why Markdown?
1. **Universal compatibility** - Works everywhere (GitHub, GitLab, Notion, VS Code, etc.)
2. **Readable raw** - Even without rendering, easy to read
3. **Version control friendly** - Git diffs work well
4. **Lightweight** - Small file sizes, no dependencies
5. **Future-proof** - Won't become obsolete

### Why Group by Rule?
- **Avoid duplication** - Same fix guidance for multiple instances
- **Clearer structure** - Easier to understand scope
- **Faster fixes** - Apply same fix to all instances
- **Better for tickets** - One ticket per rule type

### Why Include All Instances?
- **Complete picture** - Know exactly what needs fixing
- **Find patterns** - See if certain components are problematic
- **Verify fixes** - Confirm all instances were addressed

## Accessibility

The Export button itself is accessible:
- âœ… Keyboard navigable (Tab, Enter)
- âœ… Screen reader friendly (descriptive label)
- âœ… Focus visible (focus ring)
- âœ… Disabled state announced
- âœ… Success/error feedback via toast

## Performance

- **Generation:** < 50ms for typical scans (< 100 issues)
- **Download:** Instant (client-side, no network)
- **File size:** 10-50 KB typical (text only)
- **Browser support:** All modern browsers (Blob API)

## Testing

### Manual Test Cases
1. âœ… Export with issues â†’ Downloads file
2. âœ… Export with no issues â†’ Button disabled
3. âœ… Export during scan â†’ Button not shown
4. âœ… Filename format â†’ Correct slug and date
5. âœ… Markdown validity â†’ Renders correctly on GitHub
6. âœ… Large scans (100+ issues) â†’ No performance issues
7. âœ… Special characters in site name â†’ Sanitized in filename
8. âœ… Toast notifications â†’ Success/error shown

### Integration Testing
- âœ… Works with real scan data (Alterra example: 17 issues across 4 rule types)
- âœ… All remediation guides included
- âœ… Code examples formatted correctly
- âœ… WCAG references accurate
- âœ… Table of contents links work

## Support

### Common Issues

**Q: Download not starting?**
A: Check browser download settings. Some browsers block automatic downloads.

**Q: File has wrong extension?**
A: Some browsers default to .txt. Rename to .md after download.

**Q: Markdown not rendering?**
A: Use a Markdown viewer (GitHub, VS Code, Typora, etc.) or preview online.

**Q: Export button disabled?**
A: No issues were found in the scan. Button only appears when there are issues to export.

## References

- [Markdown Guide](https://www.markdownguide.org/)
- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [Blob API Documentation](https://developer.mozilla.org/en-US/docs/Web/API/Blob)
